# æ¯æ—¥æ‰“å¡åº”ç”¨ - CodeBuddy å¼€å‘æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªåŸºäº Next.js 14 + Supabase çš„ç°ä»£åŒ–æ¯æ—¥æ‰“å¡åº”ç”¨ï¼Œæ”¯æŒ Google OAuth è®¤è¯å’Œè·¨è®¾å¤‡æ•°æ®åŒæ­¥ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å¼€å‘ç¯å¢ƒå¯åŠ¨
```bash
# Windows ç”¨æˆ·
start-local-dev.bat

# Linux/Mac ç”¨æˆ·
chmod +x start-local-dev.sh && ./start-local-dev.sh

# æ‰‹åŠ¨å¯åŠ¨
npm install
npm run dev
```

### æ ¸å¿ƒå¼€å‘å‘½ä»¤
```bash
# å¼€å‘æœåŠ¡å™¨
npm run dev

# ç”Ÿäº§æ„å»º
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check

# ä»£ç æ£€æŸ¥
npm run lint

# æ•°æ®åº“ç®¡ç†
npx prisma studio
npx prisma generate
npx prisma db push

# æµ‹è¯• SQL API
node test-sql-apis.js
```

## ğŸ—ï¸ æ¶æ„æ¦‚è¿°

### æ··åˆæ•°æ®è®¿é—®æ¶æ„
é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œç»“åˆ Prisma å’ŒåŸç”Ÿ SQL çš„ä¼˜åŠ¿ï¼š

- **è®¤è¯å±‚**: NextAuth.js + JWT (é¿å…æ•°æ®åº“æŸ¥è¯¢)
- **ä¸šåŠ¡å±‚**: åŸç”Ÿ SQL + PostgreSQL è¿æ¥æ±  (é«˜æ€§èƒ½)
- **å‰ç«¯**: Next.js 14 App Router + TypeScript + Tailwind CSS

### æ ¸å¿ƒç»„ä»¶

#### æ•°æ®åº“å±‚ (`src/lib/database.ts`)
- PostgreSQL è¿æ¥æ± ç®¡ç† (æœ€å¤§20ä¸ªè¿æ¥)
- ç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£: `executeQuery`, `executeQuerySingle`, `executeTransaction`
- è‡ªåŠ¨è¿æ¥é‡Šæ”¾å’Œé”™è¯¯å¤„ç†

#### ä¸šåŠ¡æ•°æ®å±‚ (`src/lib/business-data.ts`)
- `checkInData`: æ‰“å¡è®°å½•çš„ CRUD æ“ä½œ
- `taskData`: ä»»åŠ¡å’Œä»»åŠ¡ç»„ç®¡ç†
- `statsData`: ç»Ÿè®¡æ•°æ®è®¡ç®— (è¿ç»­æ‰“å¡ã€å®Œæˆç‡ç­‰)
- æ‰€æœ‰æ“ä½œéƒ½ä½¿ç”¨åŸç”Ÿ SQLï¼Œç¡®ä¿é«˜æ€§èƒ½

#### è®¤è¯ç³»ç»Ÿ (`src/auth.ts`)
- Google OAuth 2.0 é›†æˆ
- JWT ä¼šè¯ç­–ç•¥ (30å¤©æœ‰æ•ˆæœŸ)
- ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨ token ä¸­ï¼Œé¿å…é¢‘ç¹æ•°æ®åº“æŸ¥è¯¢

## ğŸ“ å…³é”®ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/                    # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/              # NextAuth.js è®¤è¯
â”‚   â”‚   â”œâ”€â”€ checkins/          # æ‰“å¡è®°å½• API
â”‚   â”‚   â”œâ”€â”€ stats/             # ç»Ÿè®¡æ•°æ® API
â”‚   â”‚   â””â”€â”€ tasks/             # ä»»åŠ¡ç®¡ç† API
â”‚   â”œâ”€â”€ layout.tsx             # æ ¹å¸ƒå±€ (AuthProvider + ThemeProvider)
â”‚   â””â”€â”€ page.tsx               # ä¸»é¡µé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                    # åŸºç¡€ UI ç»„ä»¶ (Radix UI)
â”‚   â”œâ”€â”€ layout/                # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ timesheet/             # æ‰“å¡ç›¸å…³ç»„ä»¶
â”‚   â””â”€â”€ modals/                # æ¨¡æ€æ¡†ç»„ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ database.ts            # æ•°æ®åº“è¿æ¥æ± 
â”‚   â”œâ”€â”€ business-data.ts       # ä¸šåŠ¡æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ sql-queries.ts         # SQL æŸ¥è¯¢è¯­å¥é›†åˆ
â”‚   â”œâ”€â”€ auth-utils.ts          # è®¤è¯å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ api-client.ts          # å‰ç«¯ API å®¢æˆ·ç«¯
â””â”€â”€ store/                     # Zustand çŠ¶æ€ç®¡ç†
```

## ğŸ”§ å¼€å‘è§„èŒƒ

### API å¼€å‘
1. è®¤è¯æ£€æŸ¥: æ‰€æœ‰ä¸šåŠ¡ API éƒ½éœ€è¦éªŒè¯ç”¨æˆ·ä¼šè¯
2. æ•°æ®éš”ç¦»: åŸºäº `userId` è¿‡æ»¤æ‰€æœ‰æŸ¥è¯¢
3. é”™è¯¯å¤„ç†: ä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
4. å‚æ•°åŒ–æŸ¥è¯¢: é˜²æ­¢ SQL æ³¨å…¥æ”»å‡»

### æ•°æ®åº“æ“ä½œ
- ä¼˜å…ˆä½¿ç”¨ `business-data.ts` ä¸­çš„å°è£…æ–¹æ³•
- å¤æ‚æŸ¥è¯¢å†™åœ¨ `sql-queries.ts` ä¸­
- äº‹åŠ¡æ“ä½œä½¿ç”¨ `executeTransaction`
- è¿æ¥è‡ªåŠ¨ç®¡ç†ï¼Œæ— éœ€æ‰‹åŠ¨é‡Šæ”¾

### å‰ç«¯å¼€å‘
- ä½¿ç”¨ TypeScript ç¡®ä¿ç±»å‹å®‰å…¨
- ç»„ä»¶ä½¿ç”¨ Tailwind CSS + Radix UI
- çŠ¶æ€ç®¡ç†ä½¿ç”¨ Zustand
- æ”¯æŒæ·±è‰²æ¨¡å¼å’Œå“åº”å¼è®¾è®¡

## ğŸ›¡ï¸ å®‰å…¨æœºåˆ¶

### è®¤è¯ä¿æŠ¤
- æ‰€æœ‰ API è·¯ç”±éƒ½éœ€è¦æœ‰æ•ˆçš„ JWT token
- ç”¨æˆ·æ•°æ®å®Œå…¨éš”ç¦»ï¼ŒåŸºäº userId è¿‡æ»¤
- ä¸­é—´ä»¶å±‚é¢çš„è·¯ç”±ä¿æŠ¤

### æ•°æ®å®‰å…¨
- SQL å‚æ•°åŒ–æŸ¥è¯¢é˜²æ³¨å…¥
- æ•æ„Ÿä¿¡æ¯ä¸æš´éœ²ç»™å‰ç«¯
- è¯¦ç»†çš„æœåŠ¡å™¨ç«¯æ—¥å¿—è®°å½•

## ğŸ“Š æ•°æ®æ¨¡å‹

### æ ¸å¿ƒè¡¨ç»“æ„
- `users`: ç”¨æˆ·ä¿¡æ¯ (NextAuth.js ç®¡ç†)
- `task_groups`: ä»»åŠ¡åˆ†ç»„ (èº«ä½“é”»ç‚¼ã€å­¦ä¹ æˆé•¿ç­‰)
- `tasks`: å…·ä½“ä»»åŠ¡ (è·‘æ­¥ã€é˜…è¯»ç­‰)
- `check_ins`: æ‰“å¡è®°å½• (ç”¨æˆ·+ä»»åŠ¡+æ—¥æœŸå”¯ä¸€)
- `streaks`: è¿ç»­æ‰“å¡ç»Ÿè®¡

### é‡è¦çº¦æŸ
- åŒä¸€ç”¨æˆ·åŒä¸€å¤©åŒä¸€ä»»åŠ¡åªèƒ½æ‰“å¡ä¸€æ¬¡
- ä»»åŠ¡æŒ‰ order å­—æ®µæ’åº
- æ”¯æŒè½¯åˆ é™¤ (isActive å­—æ®µ)

## ğŸš€ éƒ¨ç½²é…ç½®

### ç¯å¢ƒå˜é‡
```bash
# NextAuth.js
NEXTAUTH_URL=your-app-url
NEXTAUTH_SECRET=your-secret-key

# Google OAuth
AUTH_GOOGLE_ID=your-google-client-id
AUTH_GOOGLE_SECRET=your-google-client-secret

# Supabase
DATABASE_URL=your-supabase-database-url
DIRECT_URL=your-supabase-direct-url
```

### ç”Ÿäº§éƒ¨ç½²
- å‰ç«¯: Vercel è‡ªåŠ¨éƒ¨ç½²
- æ•°æ®åº“: Supabase PostgreSQL
- è®¤è¯: Google OAuth 2.0

## ğŸ” è°ƒè¯•å·¥å…·

### æ•°æ®åº“è°ƒè¯•
```bash
# æŸ¥çœ‹æ•°æ®åº“å†…å®¹
npx prisma studio

# æµ‹è¯• SQL API è¿æ¥
node test-sql-apis.js

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
npm run test:db
```

### å¼€å‘è°ƒè¯•
- å¼€å‘æ¨¡å¼ä¸‹å¯ç”¨ NextAuth.js debug
- æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹å‰ç«¯é”™è¯¯
- æœåŠ¡å™¨æ—¥å¿—æŸ¥çœ‹ API é”™è¯¯

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–
- è¿æ¥æ± å¤ç”¨ (æœ€å¤§20ä¸ªè¿æ¥)
- åŸç”Ÿ SQL é¿å… ORM å¼€é”€
- å…³é”®å­—æ®µå»ºç«‹ç´¢å¼•
- æ‰¹é‡æ“ä½œå‡å°‘å¾€è¿”æ¬¡æ•°

### å‰ç«¯ä¼˜åŒ–
- Next.js 14 App Router
- ç»„ä»¶æ‡’åŠ è½½
- å›¾ç‰‡ä¼˜åŒ–
- é™æ€èµ„æºç¼“å­˜

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### API æµ‹è¯•
- ä½¿ç”¨ `test-sql-apis.js` æµ‹è¯•æ•°æ®åº“è¿æ¥
- ç¡®ä¿æ‰€æœ‰ API éƒ½æœ‰è®¤è¯ä¿æŠ¤
- éªŒè¯æ•°æ®éš”ç¦»å’Œæƒé™æ§åˆ¶

### å‰ç«¯æµ‹è¯•
- ç»„ä»¶å•å…ƒæµ‹è¯•
- ç”¨æˆ·äº¤äº’æµ‹è¯•
- è·¨æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•

## ğŸ“ å¸¸è§ä»»åŠ¡

### æ·»åŠ æ–°ä»»åŠ¡ç±»å‹
1. åœ¨ Supabase ä¸­æ·»åŠ ä»»åŠ¡ç»„å’Œä»»åŠ¡
2. æ›´æ–° `sql-queries.ts` å¦‚éœ€è¦
3. å‰ç«¯ç»„ä»¶ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ–°ä»»åŠ¡

### ä¿®æ”¹ç»Ÿè®¡é€»è¾‘
1. æ›´æ–° `statsData` ä¸­çš„ç›¸å…³æ–¹æ³•
2. ä¿®æ”¹å¯¹åº”çš„ SQL æŸ¥è¯¢
3. æ›´æ–°å‰ç«¯ç»Ÿè®¡ç»„ä»¶

### æ‰©å±•è®¤è¯æ–¹å¼
1. åœ¨ `src/auth.ts` ä¸­æ·»åŠ æ–°çš„ provider
2. é…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡
3. æ›´æ–°è®¤è¯é¡µé¢ UI

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ä»£ç è§„èŒƒ
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª ESLint é…ç½®
- ç»„ä»¶ä½¿ç”¨ PascalCase
- æ–‡ä»¶ä½¿ç”¨ kebab-case

### æäº¤è§„èŒƒ
- åŠŸèƒ½: `feat: æ·»åŠ æ–°åŠŸèƒ½`
- ä¿®å¤: `fix: ä¿®å¤bug`
- æ–‡æ¡£: `docs: æ›´æ–°æ–‡æ¡£`
- æ ·å¼: `style: æ ·å¼è°ƒæ•´`